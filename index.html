<script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

<style>
  .arjs-loader {
    height: 100%;
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .arjs-loader div {
    text-align: center;
    font-size: 1.25em;
    color: white;
  }
</style>

<body style="margin : 0px; overflow: hidden;"> 

  <!-- minimal loader shown until image descriptors are loaded -->
  <div class="arjs-loader">
    <div>Loading, please wait...</div>
  </div>
  <a-scene
    vr-mode-ui="enabled: false;"
    renderer="logarithmicDepthBuffer: true;"
    embedded
    arjs="trackingMethod: best; sourceType: webcam;debugUIEnabled: false;"
  >
  <!-- assets for vidhandler -->
  <a-assets >
      <video crossOrigin="Anonymous" Id="vid" 
  loop="true"src="https://roberlazaro.github.io/ImageWebAR/Assets/Videos/Dani1.mp4">
      </video>        
  </a-assets>
  
  <a-assets>
    <!-- Load video that is hosted on another server. See 'src' attribute: -->
    <video preload="none" id="chroma" response-type="arraybuffer" loop="false" crossorigin webkit-playsinline playsinline controls>
      <source  src="https://roberlazaro.github.io/ImageWebAR/Assets/Videos/Dani1.mp4">
  </video>
  </a-assets>
    <!-- we use cors proxy to avoid cross-origin problems -->
    <a-nft
      vidhandler="target: #vid"
      type="nft"
      url="https://roberlazaro.github.io/ImageWebAR/Assets/NFT/retiro300"
      smooth="true"
      smoothCount="10"
      smoothTolerance=".01"
      smoothThreshold="5"
      >
      <!-- add non transparent video (.mp4) -->
      <a-plane  position='0 .2 0' width='100' height='100' rotation="-90 0 0" material='src:#vid'></a-plane>
    </a-nft>
    <a-entity camera></a-entity>
  </a-scene>

 <!-- vidhandler component -->
<script>
  AFRAME.registerComponent('vidhandler', {
  schema: {
    target: {type: 'string'}
  },
  init: function() {
      this.videoNodes = document.querySelectorAll(this.data.target)
  },
  tick: function() {
      if (this.el.object3D.visible == true) {
          if (!this.toggle) {
              this.toggle = true;
              for (let i = 0; i < this.videoNodes.length; i++) {
                  this.videoNodes[i].play();
              } 
          }
      } else {
          if (this.toggle) {
            for (let i = 0; i < this.videoNodes.length; i++) {
              this.videoNodes[i].pause();
            }
            this.toggle = false;
          }
      }
  }
  });
  </script>

</body>
